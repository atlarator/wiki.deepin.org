---
title: Linux系统收发网络数据包的过程
description: 
published: true
date: 2023-06-13T01:35:27.403Z
tags: 
editor: markdown
dateCreated: 2023-06-13T01:35:09.626Z
---

- - 

```
Linux 服务器收到网络数据包，需要经过哪些处理，一步步将数据传给应用进程的呢？应用进程发送数据包时，Linux 又是如何操作将数据包发送出去的呢？今天我们就来聊聊这个话题。
```

在准备好接收网络数据包之前，Linux需要做很多准备工作，例如：网络子系统的初始化、协议栈的注册、网卡驱动的初始化、启动网卡等等,只有这些都准备好了之后，才能真正开始接收网络包。

## 网络协议栈

------

在介绍Linux收发网络数据包之前，我们先来了解一下Linux网络协议栈。

国际标准化组织制定了开放式系统互联通信参考模型（Open System Interconnection Reference Model），也就是 OSI 网络模型，该模型主要有 7 层，分别是应用层、表示层、会话层、传输层、网络层、数据链路层以及物理层。

由于 OSI 模型太复杂，提出的只是存在于概念和理论上的一种模型，分层太多，增加了网络工作的复杂性，所以没有大规模应用。
我们比较常见是TCP/IP 网络模型，Linux 系统正是按照这套网络模型来实现网络协议栈的。

TCP/IP 网络模型共有 4 层，分别是应用层、传输层、网络层和网络接口层，每一层负责的职能如下：

1、**应用层** 对应于OSI参考模型的高层，为用户提供所需要的各种服务，例如：FTP、Telnet、DNS、SMTP等.

2、**传输层** 对应于OSI参考模型的传输层，为应用层实体提供端到端的通信功能，保证了数据包的顺序传送及数据的完整性。该层定义了两个主要的协议：传输控制协议（TCP）和用户数据报协议（UDP).

3、**网络层** 对应于OSI参考模型的网络层，主要解决主机到主机的通信问题。它所包含的协议设计数据包在整个网络上的逻辑传输。注重重新赋予主机一个IP地址来完成对主机的寻址，它还负责数据包在多种网络中的路由。该层有三个主要协议：网际协议（IP）、互联网组管理协议（IGMP）和互联网控制报文协议（ICMP）。

4、**网络接口层** 与OSI参考模型中的物理层和数据链路层相对应。它负责监视数据在主机和网络之间的交换。事实上，TCP/IP本身并未定义该层的协议，而由参与互连的各网络使用自己的物理层和数据链路层协议，然后与TCP/IP的网络接入层进行连接。地址解析协议（ARP）工作在此层，即OSI参考模型的数据链路层。